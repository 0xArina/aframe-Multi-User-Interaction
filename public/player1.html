<!DOCTYPE html>
<html>
    <head>
    <title>Player 1</title>
    <script src="https://rawgit.com/bryik/aframe-bmfont-text-component/master/dist/aframe-bmfont-text-component.min.js"></script>
    <!-- load in socket -->
    <script src="/socket.io/socket.io.js"></script>
    <!-- load in aframe -->
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <!-- environment -->
    <script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
    </head>
    <body>
        <a-scene>
            <a-assets>
                <!--loading 3D models -->
                <a-asset-item id="door-obj" src="assets/OBJ/Door.obj"></a-asset-item>
                <!-- loading sound -->
            </a-assets>
            <!-- environment -->
            <a-entity environment="preset: tron; groundColor: #445; grid: 1x1"></a-entity>
             <!-- sky -->

             <!-- camera -->
            <a-entity position="0 1.6 0" camera wasd-controls look-controls></a-entity>
            <!-- lights -->

             <!-- positioning cubes -->
            
            <a-box  id="cubeT"       
                    color="#FFAA00"
                    position="-1.6 2.5 -3.2"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            <a-box  id="cube"   
                    color="#FFAA00"
                    position="-3 2 0"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            <a-box  id="cube"   
                    color="#FFAA00"
                    position="-3 2.5 -3.2"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            <a-box  id="cube" 
                    color="#FFAA00"
                    position="-3.6 2.5 -3.2"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            <a-box  id="cube" 
                    color="#FFAA00"
                    position="-7 4 -2"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            <a-box  id="cube" 
                    color="#FFAA00"
                    position="-5 2.5 -5"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            <a-box  id="cube" 
                    color="#FFAA00"
                    position="-1.6 1 2"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            <a-box  id="cube" 
                    color="#FFAA00"
                    position="-1.6 4 4"
                    scale="0.7 0.7 0.7"
                    class="clickable"
            ></a-box>
            
            <!-- adding camera mannually so we add a cursor component to it -->
            <a-entity position="0 1.2 2" camera look-controls wasd-controls>
            <!-- cursor allows us to interact with objects. Add a raycaster and set constraints too increase perfomance
            which entities will trigger the raycaster. E.g. set objects to the classname .clickable to only trigger entities
            with clickable as a class -->
            <a-entity   cursor="rayOrigin:mouse;"
                        raycaster="far:20; interval:100; objects:.clickable"
                        >
            </a-entity>
            </a-entity>
            <script>
                let socket = io();
                //socket events
                socket.on('connect', function(){
                   console.log('p1 connected');
                });
    
                //add some click events
                //when target cube clicked
               document.querySelector('#cubeT').addEventListener('click', function(){
                    console.log("target cube clicked");  
                    socket.emit('targetCubeEvent');
                    window.location.replace("/winner.html");
                });
                //when other cubes clicked
                const cubes = document.querySelectorAll("#cube")
                for (const cube of cubes) {
                cube.addEventListener('click', function(event) {
                    console.log("not target cube clicked");  
                    socket.emit('otherCubeEvent');
                })
                }

                //listening for 'cubeT_change2' event from p2
                socket.on('cubeT_change2', function(){
                console.log('in cubeT2 change');
                window.location.replace("/loser.html");
            });
               //listening for 'cube_change2' event from p2
               socket.on('cube_change2', function(){
                console.log('in cube change2');  
            });
            </script> 
        </a-scene>  
    </body>
</html>